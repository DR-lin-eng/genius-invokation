# 亟待解决的问题

## 结算顺序

当角色使用完技能后，所有监听 `onUseSkill`、 `onDealDamage`、`onElementalReaction` 的实体都会响应，并且是“同时”（按规则顺序）。

不可以先处理所有的 `onUseSkill`、再处理所有的 `onDealDamage` 这样（之前的设想），此时会导致结算顺序出错。

目前的想法：为 `Entity` 提供一个基类方法，对 `onUseSkill` 的事件处理进行“继承派发”，即每个实例收到 `onUseSkill` 信号后先处理它；如果没有（合适吗？）就再处理 `onDealDamage` 信号，再次处理 `onElementalReaction` 信号。

## 倒下时机

根据规则书和实际测试，角色技能描述期间、召唤物 `onEndPhase` 描述期间，倒下不会立即发生；（如刻晴元素爆发，后台穿透伤害击倒角色的同时，前台超载到对应角色；此时会切出 0 血角色）（温迪暴风之眼造成扩散击倒后台角色后，随后拉出最近的角色也可能是 0 血。）

按照群友们的总结，倒下结算应当发生在 `useSkill` 与 `onUseSkill` 的第一个 handler 之间。

如果 `useSkill` 引发了链式反应，比如引发切人（切出0血）->引发凯亚寒冰之棱->击倒我方角色->我方选择角色。在我方选择角色的同时（？），0血的角色开始“击倒”结算。这个时候，虽然 `useSkill` 的效果还没结束，但是击倒结算却已经发生了。

因此倒下的时机目前尚不明确。

### 例外：魔偶剑鬼元素爆发

该描述中的“触发召唤物效果”总是在击倒结算后。原因不明。

## 我方角色造成伤害时

对于自伤型状态（蹦蹦火花），似乎不算在任何一方角色造成的伤害。但是他伤型状态（琉金火光）是算在“我方角色造成伤害”的描述下的。

官方所述“我方角色造成伤害”似乎是“我方召唤物造成伤害”的反义词。

