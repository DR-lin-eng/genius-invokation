// @ts-check
import { glob } from "glob";
import { writeFile } from "node:fs/promises";

const TARGET = "data/index.ts";

const files = await glob("data/**/*.ts", {
  ignore: TARGET,
  windowsPathsNoEscape: true,
}).then((files) => files.sort());

/**
 * @param {string} path 
 */
function pathToImport(path) {
  return path.replace(/\.ts$/, "").replace(/\\/g, "/").replace(/^data\//, "./");
}

const imports = files.map((f) => `import "${pathToImport(f)}";`).join("\n");

await writeFile(TARGET, `// Generated by scripts/generate_imports.mjs
// DO NOT EDIT

${imports}
`);
